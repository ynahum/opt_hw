\documentclass{article}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{amssymb}


\title{Introduction to Numerical Optimization\\HW1}
\author{Yair Nahum 034462796 }

\begin{document}

\maketitle

%\tableofcontents{}

\section{Analytical and Numerical Differentiation}

\subsection{Analytical Differentiation}

\subsubsection{Gradient and Hessian of $f_1$}
$$f_1(x)=\phi(Ax)$$
Where:
$$f_1:\mathbb{R}^n \rightarrow \mathbb{R}$$
$$x \in \mathbb{R}^{n},$$
$$A \in \mathbb{R}^{m\times n},$$
$$\phi:\mathbb{R}^m \rightarrow \mathbb{R}$$
Assuming $\nabla\phi$ and $\nabla^2\phi$ are known (relative to its $\mathbb{R}^m$ variable).
$$\nabla f_1 = ?$$
$$\nabla^2 f_1 = ?$$

We denote $u=Ax \Rightarrow du=Adx$, by the external definition of the gradient:
$$df_1=d\phi(u)=(\nabla\phi(u))^T du = (\nabla\phi(Ax))^T A dx = $$
$$ \langle A^T\nabla \phi(Ax), dx \rangle \Rightarrow $$
\begin{center}
\begin{tabular}{ |c| }
\hline
 $$ \nabla f_1 = A^T\nabla \phi(Ax)$$\\
\hline
\end{tabular}
\end{center}

Next, We denote $\nabla f_1= g(x)$:
$$dg\equiv Hdx,d(\nabla \phi(u)) =  \nabla^2 \phi(u) du \Rightarrow$$
$$dg=d(\nabla f_1) = d(A^T\nabla \phi(Ax))=A^Td(\nabla \phi(u))=A^T\nabla^2 \phi(u) du = A^T\nabla^2 \phi(Ax) A dx \Rightarrow$$
\begin{center}
\begin{tabular}{ |c| }
\hline
$$ \nabla^2 f_1 = A^T\nabla^2 \phi(Ax) A$$\\
\hline
\end{tabular}
\end{center}

\subsubsection{Gradient and Hessian of $f_2$}

$$f_2(x)=h(\phi(x))$$
Where:
$$f_2:\mathbb{R}^n \rightarrow \mathbb{R}$$
$$x \in \mathbb{R}^{n},$$
$$\phi:\mathbb{R}^n \rightarrow \mathbb{R}$$
$$h:\mathbb{R} \rightarrow \mathbb{R},$$
Assuming $\nabla\phi, \nabla^2\phi, h'(t)$ and $h''(t)$ are known.
$$\nabla f_2 = ?$$
$$\nabla^2 f_2 = ?$$
We denote $t=\phi(x)\Rightarrow dt=d\phi(x)=(\nabla \phi(x))^Tdx$
$$df_2= dh = h'(t)dt = h'(\phi(x))(\nabla \phi(x))^Tdx=$$
Since $h'(t)$ is scalar, it doesn't change on transpose operation:
$$\langle h'(\phi(x))\nabla \phi(x), dx \rangle \Rightarrow$$
\begin{center}
\begin{tabular}{ |c| }
\hline
$$ \nabla f_2 = h'(\phi(x))\nabla \phi(x)$$\\
\hline
\end{tabular}
\end{center}
Next, We denote $\nabla f_2= g(x)$:
$$dg = d(h'(\phi(x))\nabla \phi(x)) =  d(h'(\phi(x)))\nabla \phi(x) + h'(\phi(x))d(\nabla \phi(x))=$$
$$h''(\phi(x))((\nabla \phi(x))^Tdx)\nabla \phi(x) + h'(\phi(x))\nabla^2 \phi(x)dx=$$
$$h''(\phi(x))\nabla \phi(x)((\nabla \phi(x))^Tdx) + h'(\phi(x))\nabla^2 \phi(x)dx=$$
$$h''(\phi(x))\nabla \phi(x)(\nabla \phi(x))^Tdx + h'(\phi(x))\nabla^2 \phi(x)dx=$$
$$[h''(\phi(x))\nabla \phi(x)(\nabla \phi(x))^T + h'(\phi(x))\nabla^2 \phi(x)]dx=$$
by definition $dg=Hdx$, therefore:
\begin{center}
\begin{tabular}{ |c| }
\hline
$$ \nabla^2 f_2 = h''(\phi(x))\nabla \phi(x)(\nabla \phi(x))^T + h'(\phi(x))\nabla^2 \phi(x)$$\\
\hline
\end{tabular}
\end{center}
\newpage
\subsubsection{Gradient and Hessian of $\phi$}
Given the following $\phi:\mathbb{R}^3\rightarrow\mathbb{R}$ function:
$$\phi \begin{pmatrix}x_1\\x_2\\x_3 \end{pmatrix} = sin(x_1x_2x_3)$$
We need to calculate its gradient vector and hessian matrix.
We can use the previous section results when there is a chain of functions to compute the gradient and hessian as we can define:
$$f=sin:\mathbb{R}\rightarrow\mathbb{R}$$ and $$u=x_1x_2x_3:\mathbb{R}^3\rightarrow\mathbb{R}$$
\\
Thus, the gradient is as follows:
$$\nabla \phi = f'(u)\nabla u(x) = cos(x_1x_2x_3)\begin{pmatrix}x_2x_3\\x_1x_3\\x_1x_2 \end{pmatrix}$$
\begin{center}
\begin{tabular}{ |c| }
\hline
$$\nabla \phi = cos(x_1x_2x_3)\begin{pmatrix}x_2x_3\\x_1x_3\\x_1x_2 \end{pmatrix}$$\\
\hline
\end{tabular}
\end{center}
\\
We can also use the hessian formula we got on the previous section and get:
$$\nabla^2 \phi = f''(u(x))\nabla u(x)(\nabla u(x))^T + f'(u(x))\nabla^2 u(x)=$$
$$-sin(x_1x_2x_3)\begin{pmatrix}x_2x_3\\x_1x_3\\x_1x_2 \end{pmatrix}\begin{pmatrix}x_2x_3 & x_1x_3 & x_1x_2 \end{pmatrix} + cos(x_1x_2x_3)\begin{pmatrix}0 & x_3 & x_2\\x_3 & 0 & x_1\\x_2 & x_1 & 0 \end{pmatrix} \Rightarrow$$
\begin{center}
\begin{tabular}{ |c| }
\hline
$$\nabla^2 \phi = -sin(x_1x_2x_3)\begin{pmatrix}{x_2}^2{x_3}^2 & x_1x_2{x_3}^2 & x_1{x_2}^2x_3\\x_1x_2{x_3}^2 & {x_1}^2{x_3}^2 & {x_1}^2x_2x_3\\x_1{x_2}^2x_3 & {x_1}^2x_2x_3 & {x_1}^2{x_2}^2 \end{pmatrix}+ cos(x_1x_2x_3)\begin{pmatrix}0 & x_3 & x_2\\x_3 & 0 & x_1\\x_2 & x_1 & 0 \end{pmatrix}$$\\
\hline
\end{tabular}
\end{center}

\end{document}

