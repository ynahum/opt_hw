\documentclass[12pt]{article}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{graphicx}
\graphicspath{ {./plots/} }

\newcommand{\rectres}[1]{
\begin{center}
\begin{tabular}{ |c| }
\hline
\\
 #1\\
 \\
\hline
\end{tabular}
\end{center}
}

\newcommand{\qed}{\hfill$\blacksquare$}

\title{Introduction to Numerical Optimization\\Assignment 4}
\author{Yair Nahum 034462796\\and\\blabla 11111111 }

\begin{document}

\maketitle

%\tableofcontents{}

\section{Constrained Optimization and Duality}

\subsection{Question 1}
We need to solve the following 
\begin{equation}
\label{eq:min1}
\begin{split}
    \min _x x^T M x + c^T x \\
    \text{s.t. } Ax = b
\end{split}
\end{equation}
Given:
\begin{itemize}
  \item $M \in \mathbb{R}^{n\times n},M \succ 0$
  \item $A \in \mathbb{R}^{m\times n}$
  \item $x,c \in \mathbb{R}^{n}$
  \item $b \in \mathbb{R}^{m}$
  \item Assuming $M$ and $AM^{-1}A^T$ are invertible.
\end{itemize}
M is P.D $\Rightarrow$ it is Hermitian ($M=M^*$), and since $M \in \mathbb{R}^{n\times n}$ it is symmetric($M=M^T$).\\
We require the KKT conditions (necessary conditions for $x^*$ to be optimal).\\
These conditions hold as this is a convex problem with only linear constraints.
The Lagrangian is:
$$L(x,u)=x^T M x + c^T x + u^T(Ax-b)$$
The first KKT condition $\nabla_x L(x,u)=0$:
$$\nabla_x L(x,u)=0 = 2Mx + c + A^Tu \Rightarrow$$
$$x^* = -\frac{1}{2}M^{-1}(c + A^Tu)$$
The $M$ is invertible since it is P.D.\\
The third KKT condition gives $h_i(x)=Ax-b=0$, if we put the $x^*$ in it we can isolate and get $u^*$:\\
$$-\frac{1}{2}AM^{-1}(c + A^Tu^*) = b \Rightarrow$$
$$b+\frac{1}{2}AM^{-1}c = -\frac{1}{2}AM^{-1}A^Tu^* \Rightarrow$$
$$u^* = -(AM^{-1}A^T)^{-1}(2b+AM^{-1}c)$$
We put back in $x^*$ :\\
$$x^* = -\frac{1}{2}M^{-1}(c + A^Tu) =-\frac{1}{2}M^{-1}(c + A^T(-(AM^{-1}A^T)^{-1}(2b+AM^{-1}c))) \Rightarrow $$
\rectres{$$x^* =  \frac{1}{2}M^{-1}(A^T(AM^{-1}A^T)^{-1}(2b+AM^{-1}c)-c)$$}

\subsection{Question 2}

We need to solve the following 
\begin{equation}
\label{eq:min2}
\begin{split}
    \min _x ||x - c||^2_2 \\
    \text{s.t. } Ax = b
\end{split}
\end{equation}
Given:
\begin{itemize}
  \item $A \in \mathbb{R}^{m\times n}$
  \item $x,c \in \mathbb{R}^{n}$
  \item $b \in \mathbb{R}^{m}$
  \item Assuming $AA^T$ is invertible.
\end{itemize}

We require the KKT conditions (necessary conditions for $x^*$ to be optimal).\\
These conditions hold as this is a convex problem with only linear constraints.
The Lagrangian is:
$$L(x,u)=x^Tx -2c^T x + c^Tc + u^T(Ax-b)$$
The first KKT condition $\nabla_x L(x,u)=0$:
$$\nabla_x L(x,u)= 0 = 2x -2c + A^Tu \Rightarrow$$
$$x^* = (c - \frac{1}{2} A^Tu)$$
The third KKT condition gives $h_i(x)=Ax-b=0$, if we put the $x^*$ in it we can isolate and get $u^*$:\\
$$b = A(c - \frac{1}{2} A^Tu) \Rightarrow$$
$$u^* = 2(AA^T)^{-1}(Ac-b)$$
We put back in $x^*$ :\\
$$x^* = c - \frac{1}{2} A^Tu^* = c - \frac{1}{2} A^T (2(AA^T)^{-1}(Ac-b))  \Rightarrow  $$
\rectres{$$x^* =   c - A^T(AA^T)^{-1}(Ac-b)$$}

\subsection{Question 3}

\begin{equation}
\label{eq:min3}
\begin{split}
    \min _x x^T A x + b^T x \\
    \text{s.t. } \\
    1^T_3x = 1\\
    x_3 \leq 1\\
\end{split}
\end{equation}
Given:
\begin{itemize}
  \item $A \in \mathbb{R}^{3 \times 3}$
  \item $x,b,1_3 \in \mathbb{R}^{3}$
  \item $A = \begin{bmatrix}
               1 & 1 & 0 \\
                1 & 2 & 0 \\
                0 & 0 & 0 \\
              \end{bmatrix}$
  \item $b = \begin{bmatrix}  1 \\ -1 \\ 1\\ \end{bmatrix}$
  \item $1_3 = \begin{bmatrix} 1\\  1\\  1\\ \end{bmatrix}$
\end{itemize}

\subsubsection{Is the problem convex?}
Since the constraints functions are linear $g_i(x),h_i(x)$ they are also convex.\\
The target function is convex iff $A\succcurlyeq 0$.
To check this, we can check all the principal minors to be $M_{i,i}\geq 0$ or by finding all eigenvalues to be $\lambda_i \geq 0$. 
\begin{itemize}
  \item There are 7 principal minors for $3\times3$ matrix $m=2^n-1$. The minors are: 1 ,2 ,0, 0, 0 ,1 ,0. so we found that all are greater or equal to 0. Therefore, $A\succcurlyeq 0$.
  \item Finding the eigenvalues by $det(\lambda I - A) = 0 \Rightarrow$:\\
  $$0=\lambda((\lambda-2)(\lambda-1)-1)=\lambda(\lambda^2-3\lambda+1)\Rightarrow$$
  $$\lambda_1=0, \lambda_{2,3}=\frac{3\pm \sqrt{5}}{2} \Rightarrow$$
  All eigenvalues are greater or equal to 0. Therefore, $A\succcurlyeq 0$.
\end{itemize}
Bottom line, the problem is convex as $A$ is positive semi definite. 
\subsubsection{Find and solve the dual problem}
since the problem is convex and the constraints are linear and slater's condition (SC) is true (as $x = \begin{bmatrix}  0 \\ 1 \\ 0\\ \end{bmatrix}$ is strictly feasible and $x_3 = 0 < 1$)

\end{document}

